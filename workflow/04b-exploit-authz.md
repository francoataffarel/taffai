# Fase 4b: Exploração — Autorização (Authz)
## Target: {{TARGET}}

> Baseado em: Shannon `exploit-authz.txt`
> Input: Fila de `deliverables/03b_vuln_authz.md`
> Output: `deliverables/04b_exploit_authz.md`

---

## ⚠️ Contexto: Perguntar antes de executar
> Antes de iniciar esta fase, confirmar: **HTB/CTF** ou **Real/Autorizado**?
> Isso determina quais ferramentas e técnicas são aplicáveis.

## Papel
Penetration tester de privilege escalation. Provar acesso não autorizado a dados/funções.

## Níveis de Prova
| Nível | Descrição | Classificação |
|-------|-----------|---------------|
| 1 | Fraqueza de authz identificada | POTENTIAL (Low) |
| 2 | Bypass parcial (acesso a alguns recursos) | POTENTIAL (Medium) |
| 3 | **Access control bypass** (acessou funcionalidade/dados protegidos) | **EXPLOITED** |
| 4 | **Privilege escalation crítica** (admin como user normal) | **EXPLOITED (CRITICAL)** |

## Workflow por Vulnerabilidade

### Stage 1: Confirmação
Por tipo de vulnerabilidade:
- **Horizontal (IDOR):** trocar ID de objeto no request
- **Vertical:** acessar endpoint admin com sessão de user
- **Context/Workflow:** pular steps de um processo multi-step

### Stage 2: Demonstração de Impacto
- [ ] Acessar dados de outro usuário
- [ ] Executar ação admin como user
- [ ] Modificar recurso que não pertence ao usuário

## Técnicas
```bash
# IDOR - trocar IDs
curl -b "session=USER_COOKIE" http://{{TARGET}}/api/users/1
curl -b "session=USER_COOKIE" http://{{TARGET}}/api/users/2  # outro user

# Vertical - endpoint admin com cookie user
curl -b "session=REGULAR_USER" http://{{TARGET}}/admin/settings

# Workflow bypass - pular step
curl -X POST http://{{TARGET}}/api/order/confirm  # sem passar pelo payment
```

## Deliverable → `deliverables/04b_exploit_authz.md`
Mesmo formato: Successfully Exploited + Attempted but Failed.
